(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[22],{470:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));const c="".concat("http://34.208.193.210/apipagos/api/","usuarioperfil");function s(e,t,n,s){let a=c,i="";return null!==e&&(i+="/"+e),null!==n&&(i+="/"+n),null!==t&&(i+="/"+t),a+=i,fetch(a,{method:"GET",headers:{Authorization:"Bearer "+s,Accept:"application/json"}}).then((function(e){return e.json()})).catch((e=>e))}},477:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));const c="".concat("http://34.208.193.210/apipagos/api/","usuarios");function s(e,t,n,s,a){let i=c,r="";return null!==e&&(r+="/"+e),null!==t&&(r+="/"+t),null!==n&&(r+="/"+n),null!==s&&(r+="/"+s),i+=r,fetch(i,{method:"GET",headers:{Authorization:"Bearer "+a,Accept:"application/json"}}).then((function(e){return e.json()})).catch((e=>e))}},485:function(e,t,n){"use strict";t.a=n.p+"static/media/logo.739acbb1.png"},512:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));const c="".concat("http://34.208.193.210/apipagos/api/","politicas");function s(e,t){let n=c,s="";return null!==e&&(s.length>0?s+="&id_politica="+e:s+="?id_politica="+e),null!==t&&(s.length>0?s+="&descripcion="+t:s+="?descripcion="+t),n+=s,fetch(n).then((function(e){return e.json()})).catch((e=>e))}},560:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));const c="".concat("http://34.208.193.210/apipagos/api/","loglogin");function s(e,t,n){var s={id_usuario:e,maximo:t};const a=JSON.stringify(s);return fetch(c,{method:"POST",body:a,headers:{Authorization:"Bearer "+n,Accept:"application/json","Content-type":"application/json;charset=UTF-8"}}).then((e=>e.json())).then((e=>e)).catch((e=>e))}},561:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));const c="".concat("http://34.208.193.210/apipagos/api/","login");function s(e,t){var n={user:e,password:t};const s=JSON.stringify(n);return fetch(c,{method:"POST",body:s,headers:{Accept:"application/json","Content-type":"application/json;charset=UTF-8"}}).then((e=>e.json())).then((e=>void 0!==e.length?e:null)).catch((e=>e))}},921:function(e,t,n){"use strict";n.r(t);var c=n(1),s=n(16),a=n(835),i=n(467),r=n(477),o=n(512),l=n(470),d=n(560),u=n(738),j=n.n(u);const h="".concat("http://34.208.193.210/apipagos/api/","flujoarchivo");function p(e,t){var n={id_lotepago:e,tipo_archivo:t};JSON.stringify(n);j()({method:"post",url:h,data:n,responseType:"blob"}).then((n=>{const c=window.URL.createObjectURL(new Blob([n.data])),s=document.createElement("a");s.href=c,"PDF"==t?(s.setAttribute("download","PagosLote"+e+".pdf"),document.body.appendChild(s),s.click()):(s.setAttribute("download","PagosLote"+e+".xlsx"),document.body.appendChild(s),s.click())}))}var b=n(459),O=n(485),m=n(486),f=n.n(m),x=n(462),g=n(561),v=n(10);t.default=()=>{const e=Object(s.g)(),{idLote:t}=Object(s.i)(),{session:n,clear:u}=Object(b.useSession)("PendrogonIT-Session"),[j,h]=Object(c.useState)(!1),[m,y]=Object(c.useState)(!1),[w,C]=Object(c.useState)(!1),[S,N]=Object(c.useState)(""),[E,A]=Object(c.useState)(""),[P,T]=Object(c.useState)(""),[_,k]=Object(c.useState)([]),[L,z]=Object(c.useState)(!1);Object(c.useEffect)((()=>{let e=!0;return Object(o.a)(null,null).then((t=>{e&&k(t.politicas)})),()=>e=!1}),[]);const[D,B]=Object(c.useState)({usuario:"",password:""}),[V,F]=Object(c.useState)(!0),I=e=>{B({...D,[e.target.name]:e.target.value})};function J(e){let t="";for(let n of _)n.identificador==e&&(t=n.valor);return t}const R=e=>{e.preventDefault(),Object(g.a)(D.usuario,f()(D.password,{encoding:"binary"})).then((e=>{e?Object(r.a)(null,null,D.usuario,null,e).then((n=>{if(n)if(n.users.length>0){for(let c of n.users)if(f()(D.password,{encoding:"binary"})===c.password)1==c.activo&&0==c.eliminado?(z(!0),Object(l.a)(c.id,"4","Modulo DescargaArchivos",e).then((e=>{let n=!1;for(let t of e.detalle)"Descargar"==t.descripcion&&(n=!0);n?(p(t,"PDF"),p(t,"XLSX"),F(!0)):F(!1)}))):(h(!0),T("Error!"),A("danger"),N("Parece que tu usuario ha sido bloqueado o eliminado. Consulta con el soporte t\xe9cnico."));else if(h(!0),T("Error!"),A("danger"),N("Credenciales incorrectas. Vuelva a intentarlo."),1==c.activo&&0==c.eliminado){let t=J("_LIMITE_ERROR_LOGIN_");Object(d.a)(c.id,t,e)}}else h(!0),T("Error!"),A("danger"),N("Credenciales incorrectas. Vuelva a intentarlo.");else h(!0),T("Error!"),A("danger"),N("Credenciales incorrectas. Vuelva a intentarlo.")})):(h(!0),T("Error!"),A("danger"),N("Credenciales incorrectas. Vuelva a intentarlo."))}))};return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)(a.a,{show:j,variant:E,onClose:()=>h(!1),dismissible:!0,children:[Object(v.jsx)(a.a.Heading,{children:P}),Object(v.jsx)("p",{children:S})]}),Object(v.jsxs)(a.a,{show:m,variant:E,onClose:()=>y(!1),dismissible:!0,children:[Object(v.jsx)(a.a.Heading,{children:P}),Object(v.jsx)("p",{children:S}),Object(v.jsx)("hr",{}),Object(v.jsx)("div",{className:"d-flex justify-content-end",children:Object(v.jsx)(x.c,{onClick:()=>e.push("/recuperar"),color:"primary",variant:"outline",children:"Actualizar Contrase\xf1a"})})]}),Object(v.jsx)("div",{className:"bg-light min-vh-100 d-flex flex-row align-items-center",children:Object(v.jsx)(x.i,{children:Object(v.jsx)(x.B,{className:"justify-content-center",children:Object(v.jsx)(x.h,{md:"9",children:Object(v.jsxs)(x.f,{children:[Object(v.jsx)(x.d,{className:"p-4",children:Object(v.jsx)(x.e,{children:Object(v.jsxs)(x.p,{children:[Object(v.jsx)("h1",{children:"Descarga de archivos de lotes"}),Object(v.jsx)("p",{className:"text-medium-emphasis",children:"Valide sus credenciales del sistema para descargar archivos"}),Object(v.jsxs)("div",{className:L?"text-medium-emphasis":"d-none text-medium-emphasis",children:[Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),V?"Espere un momento, se est\xe1 procesando la descarga.":"No tiene permisos para descargar los archivos"]}),Object(v.jsxs)(x.y,{className:L?"d-none mb-3":"mb-3",children:[Object(v.jsx)(x.z,{children:Object(v.jsx)(i.z,{})}),Object(v.jsx)(x.r,{placeholder:"Correo o Usuario",name:"usuario",onChange:I})]}),Object(v.jsxs)(x.y,{className:L?"d-none mb-4":"mb-4",children:[Object(v.jsx)(x.z,{children:Object(v.jsx)(i.r,{})}),Object(v.jsx)(x.r,{type:w?"text":"password",name:"password",placeholder:"Password",onChange:I}),Object(v.jsx)(x.c,{color:"secondary",variant:"outline",onClick:()=>{C(!w)},children:Object(v.jsx)(i.j,{})})]}),Object(v.jsxs)(x.B,{className:L?"d-none":"",children:[Object(v.jsx)(x.h,{xs:"6",children:Object(v.jsx)(x.c,{type:"submit",color:"primary",className:"px-4",onClick:R,onSubmit:R,children:"Validar credenciales"})}),Object(v.jsx)(x.h,{xs:"6",className:"text-right",children:" "})]})]})})}),Object(v.jsx)(x.d,{className:"text-blue py-5",children:Object(v.jsx)(x.e,{className:"text-center",children:Object(v.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:Object(v.jsx)("div",{style:{width:"80%",height:"80%",backgroundColor:"transparent"},children:Object(v.jsx)("img",{style:{width:"80%"},src:O.a})})})})})]})})})})})]})}}}]);
//# sourceMappingURL=22.2ce772f6.chunk.js.map