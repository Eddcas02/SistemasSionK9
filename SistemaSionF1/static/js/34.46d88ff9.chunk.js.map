{"version":3,"sources":["services/getSoporteBitacora.js","views/components/bitacora/Bitacora.js"],"names":["API","process","getSoporteBitacora","inicio","fin","id","token","ApiFinal","ApiWhere","fetch","method","headers","Authorization","Accept","then","response","json","catch","error","Bitacora","history","useHistory","session","clear","useSession","results","setList","useState","permisos","setPermisos","setInicio","final","setFinal","useEffect","mounted","idUsuario","dateIniFormat","dateFinFormat","sessionStorage","getItem","dateIni","Date","setHours","getHours","toISOString","split","dateFin","setDate","getDate","setItem","api_token","items","bitacora","getPerfilUsuario","detalle","customStyles","headRow","style","borderTopStyle","borderTopWidth","borderTopColor","defaultThemes","default","divider","headCells","paddingLeft","paddingRight","fontSize","borderRightStyle","borderRightWidth","borderRightColor","cells","columns","useMemo","name","selector","row","nombre_usuario","center","sortable","wrap","nombre","apellido","fecha_hora","accion","objeto","cell","color","size","title","onClick","push","pathname","id_bitacora","width","tableData","data","filterPlaceholder","export","print","display","gap","flexDirection","justifyContent","defaultValue","type","onChange","e","fecha","target","value","async","noDataComponent","pagination","paginationPerPage","responsive","persistTableHead","striped","dense","className"],"mappings":"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","file":"static/js/34.46d88ff9.chunk.js","sourcesContent":["const API = `${process.env.REACT_APP_API_URL}soportebitacora`\n\nexport function getSoporteBitacora(inicio, fin, id, token) {\n  let ApiFinal = API\n  let ApiWhere = ''\n  if (inicio !== null) {\n    ApiWhere += '/' + inicio + '/' + fin\n  }\n  if (id !== null) {\n    ApiWhere += '/' + id\n  }\n  ApiFinal += ApiWhere\n  return fetch(ApiFinal, {\n    method: 'GET',\n    headers: {\n      Authorization: 'Bearer ' + token,\n      Accept: 'application/json',\n    },\n  })\n    .then(function (response) {\n      return response.json()\n    })\n    .catch((error) => error)\n}\n","import React, { useState, useEffect, useMemo } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport { getSoporteBitacora } from '../../../services/getSoporteBitacora'\nimport { getPerfilUsuario } from '../../../services/getPerfilUsuario'\nimport { useSession } from 'react-use-session'\nimport { FaList, FaSearch } from 'react-icons/fa'\nimport '../../../scss/estilos.scss'\nimport { CButton } from '@coreui/react'\nimport DataTable, { defaultThemes } from 'react-data-table-component'\nimport DataTableExtensions from 'react-data-table-component-extensions'\nimport 'react-data-table-component-extensions/dist/index.css'\nimport 'react-datepicker/dist/react-datepicker.css'\nimport DatePicker, { registerLocale } from 'react-datepicker'\n\nconst Bitacora = () => {\n  const history = useHistory()\n  const { session, clear } = useSession('PendrogonIT-Session')\n  const [results, setList] = useState([])\n  const [permisos, setPermisos] = useState([])\n  const [inicio, setInicio] = useState('')\n  const [final, setFinal] = useState('')\n\n  useEffect(() => {\n    let mounted = true\n    let objeto = 'Modulo Bitacora'\n    let idUsuario = 0\n    if (session) {\n      idUsuario = session.id\n    }\n    let dateIniFormat = ''\n    let dateFinFormat = ''\n    if (\n      sessionStorage.getItem('fechaBitacoraInicial') === null &&\n      sessionStorage.getItem('fechaBitacoraFinal') === null\n    ) {\n      let dateIni = new Date()\n      dateIni.setHours(dateIni.getHours() - 6)\n      dateIniFormat = dateIni.toISOString().split('T')[0]\n      let dateFin = new Date()\n      dateFin.setHours(dateFin.getHours() - 6)\n      dateFin.setDate(dateFin.getDate() + 1)\n      dateFinFormat = dateFin.toISOString().split('T')[0]\n      setInicio(dateIniFormat)\n      sessionStorage.setItem('fechaBitacoraInicial', dateIniFormat)\n      setFinal(dateFinFormat)\n      sessionStorage.setItem('fechaBitacoraFinal', dateFinFormat)\n    } else {\n      setInicio(sessionStorage.getItem('fechaBitacoraInicial'))\n      dateIniFormat = sessionStorage.getItem('fechaBitacoraInicial')\n      setFinal(sessionStorage.getItem('fechaBitacoraFinal'))\n      dateFinFormat = sessionStorage.getItem('fechaBitacoraFinal')\n    }\n    getSoporteBitacora(dateIniFormat, dateFinFormat, null, session.api_token).then((items) => {\n      if (mounted) {\n        setList(items.bitacora)\n      }\n    })\n    getPerfilUsuario(idUsuario, '2', objeto, session.api_token).then((items) => {\n      if (mounted) {\n        setPermisos(items.detalle)\n      }\n    })\n    return () => (mounted = false)\n  }, [])\n\n  async function Buscar() {\n    await getSoporteBitacora(inicio, final, null, session.api_token).then((items) => {\n      setList(items.bitacora)\n    })\n  }\n\n  const customStyles = {\n    headRow: {\n      style: {\n        borderTopStyle: 'solid',\n        borderTopWidth: '1px',\n        borderTopColor: defaultThemes.default.divider.default,\n      },\n    },\n    headCells: {\n      style: {\n        paddingLeft: '8px', // override the cell padding for head cells\n        paddingRight: '8px',\n        fontSize: '12px',\n        '&:not(:last-of-type)': {\n          borderRightStyle: 'solid',\n          borderRightWidth: '1px',\n          borderRightColor: defaultThemes.default.divider.default,\n        },\n      },\n    },\n    cells: {\n      style: {\n        '&:not(:last-of-type)': {\n          borderRightStyle: 'solid',\n          borderRightWidth: '1px',\n          borderRightColor: defaultThemes.default.divider.default,\n        },\n      },\n    },\n  }\n  const columns = useMemo(() => [\n    {\n      name: 'Usuario',\n      selector: (row) => row.nombre_usuario,\n      center: true,\n      style: {\n        fontSize: '11px',\n      },\n      sortable: true,\n      wrap: true,\n    },\n    {\n      name: 'Nombre',\n      selector: (row) => row.nombre + ' ' + row.apellido,\n      center: true,\n      style: {\n        fontSize: '11px',\n      },\n      sortable: true,\n      wrap: true,\n    },\n    {\n      name: 'Fecha',\n      selector: (row) => row.fecha_hora,\n      center: true,\n      style: {\n        fontSize: '11px',\n      },\n      sortable: true,\n    },\n    {\n      name: 'AcciÃ³n',\n      selector: (row) => row.accion,\n      center: true,\n      style: {\n        fontSize: '11px',\n      },\n      sortable: true,\n    },\n    {\n      name: 'Objeto',\n      selector: (row) => row.objeto,\n      center: true,\n      style: {\n        fontSize: '11px',\n      },\n      sortable: true,\n    },\n    {\n      name: 'Acciones',\n      cell: function OrderItems(row) {\n        return (\n          <div>\n            <CButton\n              color=\"primary\"\n              size=\"sm\"\n              title=\"Detalle\"\n              onClick={() =>\n                history.push({\n                  pathname: '/detallebitacora',\n                  id_bitacora: row.id_bitacora,\n                })\n              }\n            >\n              <FaList />\n            </CButton>\n          </div>\n        )\n      },\n      center: true,\n      width: '200px',\n    },\n  ])\n\n  const tableData = {\n    columns,\n    data: results,\n    filterPlaceholder: 'Filtrar datos',\n    export: false,\n    print: false,\n  }\n\n  function registrarInicio(fecha) {\n    setInicio(fecha)\n    sessionStorage.setItem('fechaBitacoraInicial', fecha)\n  }\n\n  function registrarFinal(fecha) {\n    setFinal(fecha)\n    sessionStorage.setItem('fechaBitacoraFinal', fecha)\n  }\n\n  if (session) {\n    return (\n      <>\n        <div\n          style={{ display: 'flex', gap: '10px', flexDirection: 'row', justifyContent: 'flex-end' }}\n        >\n          De:\n          <input\n            defaultValue={inicio}\n            type=\"date\"\n            onChange={(e) => {\n              registrarInicio(e.target.value)\n            }}\n          />\n          A:\n          <input\n            defaultValue={final}\n            type=\"date\"\n            onChange={(e) => {\n              registrarFinal(e.target.value)\n            }}\n          />{' '}\n          <CButton color=\"primary\" size=\"sm\" title=\"Buscar\" onClick={Buscar}>\n            <FaSearch />\n          </CButton>\n        </div>\n        <DataTableExtensions {...tableData}>\n          <DataTable\n            columns={columns}\n            noDataComponent=\"No hay registros que mostrar\"\n            data={results}\n            customStyles={customStyles}\n            pagination\n            paginationPerPage={25}\n            responsive={true}\n            persistTableHead\n            striped={true}\n            dense\n          />\n        </DataTableExtensions>\n      </>\n    )\n  } else {\n    history.push('/')\n    return <div className=\"sin-sesion\">SIN SESIÃN ACTIVA.</div>\n  }\n}\n\nexport default Bitacora\n"],"sourceRoot":""}