(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[77],{596:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));const i="".concat("http://34.208.193.210/apipagos/api/","archivosflujo");function c(e,t,a,c,r,o,n,s){let l=i,d="";var j={id_archivoflujo:e,id_flujo:t,id_usuario:a,descripcion:c,archivos:r,nombre_archivo:o,opcion:n,url:"".concat("http://34.208.193.210/pagos/archivos/")};const h=JSON.stringify(j);return""!==e&&""!==n&&(d+="/"+e+"/"+n),l+=d,fetch(l,{method:"POST",body:h,headers:{Authorization:"Bearer "+s,Accept:"application/json","Content-type":"application/json;charset=UTF-8"}}).then((e=>e.json())).then((e=>e)).catch((e=>e))}},929:function(e,t,a){"use strict";a.r(t);var i=a(1),c=a(61),r=a.n(c),o=a(459),n=a(719),s=a(818),l=a(835),d=(a(465),a(16)),j=(a(803),a(804)),h=a.n(j),p=a(685),b=a(10);var u=e=>{const[t,a]=Object(i.useState)(""),[c,r]=Object(i.useState)("");return Object(b.jsx)(h.a,{getUploadParams:({file:e,meta:a})=>{const i=new FormData;let r;return r="image/png"===e.type||"image/jpeg"===e.type?function(e){var t=new Image;t.src=e;const a=new p.a({compress:!0}),i=a.getImageProperties(t);let c=a.internal.pageSize.getWidth(),r=a.internal.pageSize.getHeight(),o=i.height*c/i.width,n=o,s=5;for(a.addImage(t,"PNG",0,s,c,o,"","FAST"),n-=r;n>=0;)s-=297,a.addPage(),a.addImage(t,"PNG",0,s,c,o,"","FAST"),n-=r;return a.output("blob")}(URL.createObjectURL(e)):e,i.append("original",e),i.append("image",r),i.append("prefijo",t),i.append("prefijoTmp",c),{url:"".concat("http://34.208.193.210/pagos/adminpagos-service/","upload.php"),body:i}},onChangeStatus:({meta:i,file:o},n)=>{let s,l=e.nombre;"preparing"===n&&(s=function(e){for(var t=[],a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=a.length,c=0;c<e;c++)t.push(a.charAt(Math.floor(Math.random()*i)));return t.join("")}(6)+"_"+l,("image/png"===o.type||"image/jpeg"===o.type||"application/pdf"===o.type)&&(a(s+".pdf"),r(s))),"done"===n&&e.sendData(t+"|original_"+c+"_"+o.name),"removed"===n&&e.sendDataRemove(t+"|original_"+c+"_"+o.name)},onSubmit:(t,a)=>{a.forEach((e=>e.remove())),e.senDataRemoveAll()},inputContent:"Cargar Archivo",accept:"image/*,application/pdf",inputWithFilesContent:e=>"Cargar otro",submitButtonContent:"Limpiar"})},O=a(494),g=a(596),x=a(495),m=a(463),f=a(467),v=(a(460),a(462)),y=a(464),S=a(509),C=a(469),w=a.n(C),_=a(471),A=a.n(_);a(472),a(683),a(684);t.default=e=>{const t=Object(d.g)(),a=Object(d.h)(),[c,j]=Object(i.useState)(null),{session:h,clear:p}=Object(o.useSession)("PendrogonIT-Session"),[_,k]=Object(i.useState)([]),[D,N]=Object(i.useState)(!1),[R,T]=Object(i.useState)(!1),[E,F]=Object(i.useState)(""),[P,z]=Object(i.useState)("danger"),[I,B]=Object(i.useState)("Error!"),[H,L]=Object(i.useState)(a.pago),[K,M]=Object(i.useState)([]),[G,U]=Object(i.useState)(!1),[W,q]=Object(i.useState)("https://arxiv.org/pdf/quant-ph/0410100.pdf"),J=_,[V,Y]=Object(i.useState)(!1),[Q,X]=Object(i.useState)(0),[Z,$]=Object(i.useState)(!1),[ee,te]=Object(i.useState)(!1),[ae,ie]=Object(i.useState)(""),[ce,re]=Object(i.useState)(""),[oe,ne]=Object(i.useState)(0),[se,le]=Object(i.useState)(!1);Object(i.useEffect)((()=>{let e=!0;return Object(S.a)(a.id_flujo,null,h.api_token).then((t=>{e&&(t.archivos.length>0?a.estado>1?le(!1):le(!0):le(!1),k(t.archivos))})),()=>e=!1}),[V]);const de=e=>{L(e.target.value)},je=async e=>{if(e.preventDefault(),""!==H&&K.length>0){"OK"===await Object(g.a)("",a.id_flujo,h.id,H,K,"","",h.api_token)&&(Y(!V),ue(),X(Q+1))}else N(!0),B("Error!"),z("danger"),F("No has llenado todos los campos.")};async function he(e){if(1==e)T(!1);else if(2==e){let e=0;h&&(e=h.id);"OK"===await Object(m.a)(e,null,null,"2",h.api_token)&&(p(),t.push("/"))}}const pe=e=>{M([...K,e])},be=e=>{M([...K.filter((function(t){return t!==e}))])},ue=()=>{M([])},Oe={headRow:{style:{borderTopStyle:"solid",borderTopWidth:"1px",borderTopColor:C.defaultThemes.default.divider.default}},headCells:{style:{paddingLeft:"8px",paddingRight:"8px",fontSize:"12px","&:not(:last-of-type)":{borderRightStyle:"solid",borderRightWidth:"1px",borderRightColor:C.defaultThemes.default.divider.default}}},cells:{style:{"&:not(:last-of-type)":{borderRightStyle:"solid",borderRightWidth:"1px",borderRightColor:C.defaultThemes.default.divider.default}}}},ge=Object(i.useMemo)((()=>[{name:"#",selector:(e,t)=>t+1,sortable:!0,width:"60px"},{name:"Usuario",selector:e=>e.nombre_usuario,center:!0,sortable:!0,wrap:!0,width:"170px"},{name:"Nombre Archivo",selector:e=>e.descripcion,center:!0,sortable:!0,wrap:!0,width:"190px"},{name:"Archivo",cell:function(e){return Object(b.jsx)("div",{style:{alignItems:"center"},children:Object(b.jsx)("object",{data:e.archivo,type:"application/pdf",width:"100%",height:"100%",children:Object(b.jsxs)("p",{children:["Alternative text - include a link ",Object(b.jsx)("a",{href:e.archivo,children:"to the PDF!"})]})})})},center:!0,width:"490px"},{name:"Acciones",cell:function(e){return Object(b.jsxs)("div",{style:{alignItems:"center"},children:[Object(b.jsx)(n.a,{variant:"outline-danger",size:"sm",target:"_blank",title:"Ver PDF",onClick:()=>{return t=e.archivo,a=h.user_name,q(t),B("Cargado por "+a),void U(!0);var t,a},children:Object(b.jsx)(y.q,{})})," ",Object(b.jsx)(v.c,{color:"success",size:"sm",title:"Editar archivo",onClick:()=>t.push({pathname:"/archivoflujo/editar",id_archivoflujo:e.id_archivoflujo,ArchivoOriginal:e.archivo_original,id_flujo:a.id_flujo,pago:a.pago,grupo:a.grupo,estado:a.estado}),children:Object(b.jsx)(y.i,{})})," ",Object(b.jsx)(v.c,{color:"danger",size:"sm",title:"Eliminar archivo",onClick:()=>{return t=e.id_archivoflujo,ne(t),ie("\xbfEst\xe1 seguro de eliminar este archivo?"),void $(!0);var t},children:Object(b.jsx)(y.s,{})})]})},center:!0,width:"130px"}])),xe={columns:ge,data:J,filterPlaceholder:"Filtrar datos",export:!1,print:!1};async function me(e){if(1==e){"OK"===await Object(g.a)(oe,"","","","","","1",h.api_token)&&Y(!V),$(!1)}else 2==e?$(!1):3==e?(te(!1),(async()=>{if(await Object(O.a)(a.id_flujo,"",a.grupo,"",null,h.id,h.api_token),null==a.grupo)"OK"===await Object(x.a)(a.id_flujo,"2",h.id,"Documento de pago cargado","0",h.api_token)&&t.go(-1);else{const e=await Object(x.a)(a.id_flujo,"2",h.id,"Documento de pago cargado","0",h.api_token),i=await Object(x.a)(a.id_flujo,"3",h.id,"Asignado a responsable","0",h.api_token);"OK"===e&&"OK"===i&&"OK"===await Object(O.a)(a.id_flujo,"",a.grupo,"",null,h.id,h.api_token)&&t.go(-1)}})()):4==e&&te(!1)}return h?a.id_flujo?Object(b.jsxs)(b.Fragment,{children:[G&&r.a.createPortal(Object(b.jsxs)("div",{style:{background:"rgba(0,0,0,0.7)",left:0,position:"fixed",top:0,height:"100%",width:"100%",zIndex:10001,display:"flex",flexDirection:"column",overflowY:"scroll"},children:[Object(b.jsx)("div",{className:"float-right",style:{margin:"10px",textAlign:"right"},children:Object(b.jsx)(n.a,{variant:"danger",size:"sm",onClick:()=>U(!1),children:"Cerrar"})}),Object(b.jsx)("object",{data:W,type:"application/pdf",width:"100%",height:"100%",children:Object(b.jsxs)("p",{children:["Alternative text - include a link ",Object(b.jsx)("a",{href:W,children:"to the PDF!"})]})})]}),document.body),Object(b.jsx)("div",{className:"float-left",style:{marginBottom:"10px"},children:Object(b.jsxs)(n.a,{variant:"primary",size:"sm",onClick:()=>t.goBack(),children:[Object(b.jsx)(y.c,{}),"\xa0\xa0Regresar"]})}),Object(b.jsx)("div",{className:"float-right",style:{marginBottom:"10px"},children:Object(b.jsx)(n.a,{className:se?"":"d-none",variant:"success",size:"sm",onClick:()=>(re("\xbfEst\xe1 seguro de finalizar la carga y pasar al siguiente paso?"),void te(!0)),children:"Finalizar carga de archivos"})}),Object(b.jsx)("br",{}),Object(b.jsx)("br",{}),Object(b.jsx)("div",{style:{flexDirection:"row"},children:Object(b.jsxs)(v.i,{children:[Object(b.jsxs)(s.a,{responsive:!0,variant:"primary",show:R,onHide:()=>he(2),centered:!0,children:[Object(b.jsx)(s.a.Header,{closeButton:!0,children:Object(b.jsx)(s.a.Title,{children:"Confirmaci\xf3n"})}),Object(b.jsx)(s.a.Body,{children:E}),Object(b.jsxs)(s.a.Footer,{children:[Object(b.jsx)(v.c,{color:"secondary",onClick:()=>he(2),children:"Cancelar"}),Object(b.jsx)(v.c,{color:"primary",onClick:()=>he(1),children:"Aceptar"})]})]},"showM"),Object(b.jsxs)(s.a,{responsive:!0,variant:"primary",show:Z,onHide:()=>me(2),centered:!0,children:[Object(b.jsx)(s.a.Header,{closeButton:!0,children:Object(b.jsx)(s.a.Title,{children:"Confirmaci\xf3n"})}),Object(b.jsx)(s.a.Body,{children:ae}),Object(b.jsxs)(s.a.Footer,{children:[Object(b.jsx)(v.c,{color:"secondary",onClick:()=>me(2),children:"Cancelar"}),Object(b.jsx)(v.c,{color:"primary",onClick:()=>me(1),children:"Aceptar"})]})]},"showME"),Object(b.jsxs)(s.a,{responsive:!0,variant:"primary",show:ee,onHide:()=>me(4),centered:!0,children:[Object(b.jsx)(s.a.Header,{closeButton:!0,children:Object(b.jsx)(s.a.Title,{children:"Confirmaci\xf3n"})}),Object(b.jsx)(s.a.Body,{children:ce}),Object(b.jsxs)(s.a.Footer,{children:[Object(b.jsx)(v.c,{color:"secondary",onClick:()=>me(4),children:"Cancelar"}),Object(b.jsx)(v.c,{color:"primary",onClick:()=>me(3),children:"Aceptar"})]})]},"showMF"),Object(b.jsxs)(l.a,{show:D,variant:P,onClose:()=>N(!1),dismissible:!0,children:[Object(b.jsx)(l.a.Heading,{children:I}),Object(b.jsx)("p",{children:E})]}),Object(b.jsx)("br",{}),Object(b.jsx)("br",{}),Object(b.jsx)(v.d,{style:{display:"flex",alignItems:"center"},children:Object(b.jsx)(v.e,{style:{width:"80%"},children:Object(b.jsxs)(v.p,{style:{width:"100%"},children:[Object(b.jsx)("h1",{children:"Creaci\xf3n de Archivos de Flujo"}),Object(b.jsx)("p",{className:"text-medium-emphasis",children:"Cree un nuevo archivo de flujo"}),Object(b.jsxs)(v.y,{className:"mb-3",children:[Object(b.jsx)(v.z,{children:Object(b.jsx)(f.k,{})}),Object(b.jsx)(v.r,{placeholder:"Descripci\xf3n",name:"descripcion",className:"form-control",defaultValue:a.pago,onChange:de})]}),Object(b.jsx)(u,{sendData:pe,sendDataRemove:be,senDataRemoveAll:ue,nombre:a.pago},Q),Object(b.jsx)(v.c,{color:"primary",block:!0,onClick:je,style:{marginTop:"15px"},children:"Cargar Archivo"})]})})})]})}),Object(b.jsx)("br",{}),Object(b.jsx)("br",{}),Object(b.jsx)("div",{style:{flexDirection:"row"},children:Object(b.jsx)(v.i,{children:Object(b.jsx)(v.d,{style:{display:"flex",alignItems:"center"},children:Object(b.jsxs)(v.e,{style:{width:"100%"},children:[Object(b.jsx)("h1",{children:"Archivos de Flujo"}),Object(b.jsx)("br",{}),Object(b.jsx)("br",{}),Object(b.jsx)(A.a,{...xe,children:Object(b.jsx)(w.a,{columns:ge,noDataComponent:"No hay archivos que mostrar",data:J,customStyles:Oe,pagination:!0,paginationPerPage:25,responsive:!0,persistTableHead:!0,striped:!0,dense:!0})})]})})})})]}):(t.go(-1),Object(b.jsx)("div",{className:"sin-sesion",children:"NO SE CARG\xd3 EL N\xdaMERO DE PAGO. REGRESE A LA PANTALLA DE PAGOS."})):(t.push("/"),Object(b.jsx)("div",{className:"sin-sesion",children:"SIN SESI\xd3N ACTIVA."}))}}}]);
//# sourceMappingURL=77.7eeb9e18.chunk.js.map