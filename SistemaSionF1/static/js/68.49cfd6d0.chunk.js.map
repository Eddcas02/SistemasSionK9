{"version":3,"sources":["services/getGruposAutorizacion.js","services/getSugerenciaAsignacionFlujo.js","views/components/flujos/flujo/FlujoGrupo.js"],"names":["API","process","getGruposAutorizacion","idGrupo","idGrupoPadre","token","ApiFinal","ApiWhere","fetch","method","headers","Authorization","Accept","then","response","json","catch","error","FlujoGrupo","props","history","useHistory","location","useLocation","time","setTime","useState","session","clear","useSession","show","setShow","showM","setShowM","results","setList","mensaje","setMensaje","sugerencias","setSugerencias","showRadio","setShowRadio","haySugerencias","setHaySugerencias","inputSeleccion","setInputSeleccion","form","setValues","grupo_autorizacion","estado","grupo_autorizacion_radio","useEffect","mounted","api_token","items","grupos","idFlujo","getSugerenciaAsignacionFlujo","id_flujo","length","handleInput","event","target","name","value","handleSubmit","async","preventDefault","id_grupo_autorizacion","postFlujos","id","postFlujoDetalle","go","Cancelar","opcion","idUsuario","postSesionUsuario","push","style","flexDirection","Alert","variant","onClose","dismissible","Heading","Modal","responsive","onHide","centered","Header","closeButton","Title","Body","Footer","color","onClick","className","marginBottom","Button","size","goBack","display","alignItems","width","onSubmit","type","placeholder","pago","disabled","onChange","map","item","i","eliminado","activo","id_grupo","identificador","id_grupoautorizacion","label","block"],"mappings":"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","file":"static/js/68.49cfd6d0.chunk.js","sourcesContent":["const API = `${process.env.REACT_APP_API_URL}grupoautorizacion`\n\nexport function getGruposAutorizacion(idGrupo, idGrupoPadre, token) {\n  let ApiFinal = API\n  let ApiWhere = ''\n  if (idGrupo !== null) {\n    ApiWhere += '/' + idGrupo\n  }\n  if (idGrupoPadre !== null) {\n    ApiWhere += '/' + idGrupoPadre\n  }\n  ApiFinal += ApiWhere\n  return fetch(ApiFinal, {\n    method: 'GET',\n    headers: {\n      Authorization: 'Bearer ' + token,\n      Accept: 'application/json',\n    },\n  })\n    .then(function (response) {\n      return response.json()\n    })\n    .catch((error) => error)\n}\n","const API = `${process.env.REACT_APP_API_URL}sugerenciaasignacionflujo`\n\nexport function getSugerenciaAsignacionFlujo(idFlujo, token) {\n  let ApiFinal = API\n  let ApiWhere = ''\n  if (idFlujo !== null) {\n    ApiWhere += '/' + idFlujo\n  }\n  ApiFinal += ApiWhere\n  return fetch(ApiFinal, {\n    method: 'GET',\n    headers: {\n      Authorization: 'Bearer ' + token,\n      Accept: 'application/json',\n    },\n  })\n    .then(function (response) {\n      return response.json()\n    })\n    .catch((error) => error)\n}\n","import React, { useState, useEffect } from 'react'\nimport { useSession } from 'react-use-session'\nimport { Alert, Modal, Button } from 'react-bootstrap'\nimport { useIdleTimer } from 'react-idle-timer'\nimport { useHistory, useLocation } from 'react-router-dom'\nimport { postFlujos } from '../../../../services/postFlujos'\nimport { postFlujoDetalle } from '../../../../services/postFlujoDetalle'\nimport { postSesionUsuario } from '../../../../services/postSesionUsuario'\nimport { getGruposAutorizacion } from '../../../../services/getGruposAutorizacion'\nimport { getSugerenciaAsignacionFlujo } from '../../../../services/getSugerenciaAsignacionFlujo'\nimport '../../../../scss/estilos.scss'\nimport { FiCreditCard } from 'react-icons/fi'\nimport { FaUsers, FaArrowLeft } from 'react-icons/fa'\nimport {\n  CButton,\n  CCard,\n  CCardBody,\n  CContainer,\n  CForm,\n  CFormControl,\n  CInputGroup,\n  CInputGroupText,\n  CFormSelect,\n  CFormCheck,\n} from '@coreui/react'\n\nconst FlujoGrupo = (props) => {\n  const history = useHistory()\n  const location = useLocation()\n  const [time, setTime] = useState(null)\n  const { session, clear } = useSession('PendrogonIT-Session')\n  const [show, setShow] = useState(false)\n  const [showM, setShowM] = useState(false)\n  const [results, setList] = useState([])\n  const [mensaje, setMensaje] = useState('')\n  const [sugerencias, setSugerencias] = useState([])\n  const [showRadio, setShowRadio] = useState(false)\n  const [haySugerencias, setHaySugerencias] = useState(false)\n  const [inputSeleccion, setInputSeleccion] = useState('')\n\n  const [form, setValues] = useState({\n    grupo_autorizacion: '',\n    estado: '',\n    grupo_autorizacion_radio: '',\n  })\n\n  useEffect(() => {\n    let mounted = true\n    getGruposAutorizacion(null, null, session.api_token).then((items) => {\n      if (mounted) {\n        setList(items.grupos)\n      }\n    })\n    getSugerenciaAsignacionFlujo(location.id_flujo, session.api_token).then((items) => {\n      if (mounted) {\n        setSugerencias(items.sugerencias)\n        if (items.sugerencias.length > 0) {\n          setShowRadio(true)\n          setHaySugerencias(true)\n        }\n      }\n    })\n    return () => (mounted = false)\n  }, [])\n\n  const handleInput = (event) => {\n    if (event.target.name == 'grupo_autorizacion') {\n      if (event.target.value == 0 && haySugerencias) {\n        setShowRadio(true)\n        setInputSeleccion('grupo_autorizacion_radio')\n      } else {\n        setShowRadio(false)\n        setInputSeleccion('grupo_autorizacion')\n      }\n    }\n    if (event.target.name == 'grupo_autorizacion_radio') {\n      setInputSeleccion('grupo_autorizacion_radio')\n    }\n    setValues({\n      ...form,\n      [event.target.name]: event.target.value,\n    })\n  }\n\n  const handleSubmit = async (event) => {\n    if (form.grupo_autorizacion !== '' || form.grupo_autorizacion_radio !== '') {\n      event.preventDefault()\n      let id_grupo_autorizacion = ''\n      if (inputSeleccion == 'grupo_autorizacion') {\n        id_grupo_autorizacion = form.grupo_autorizacion\n      } else {\n        id_grupo_autorizacion = form.grupo_autorizacion_radio\n      }\n      const respuesta = await postFlujos(\n        location.id_flujo,\n        '',\n        id_grupo_autorizacion,\n        '',\n        null,\n        session.id,\n        session.api_token,\n      )\n      if (respuesta === 'OK') {\n        const answer = await postFlujoDetalle(\n          location.id_flujo,\n          '3',\n          session.id,\n          'Asignado a responsable',\n          '0',\n          session.api_token,\n        )\n        if (answer === 'OK') {\n          history.go(-1)\n        }\n      }\n    } else {\n      event.preventDefault()\n      setShow(true)\n    }\n  }\n\n  async function Cancelar(opcion) {\n    if (opcion == 1) {\n      setShowM(false)\n    } else if (opcion == 2) {\n      let idUsuario = 0\n      if (session) {\n        idUsuario = session.id\n      }\n      const respuesta = await postSesionUsuario(idUsuario, null, null, '2', session.api_token)\n      if (respuesta === 'OK') {\n        clear()\n        history.push('/')\n      }\n    }\n  }\n\n  if (session) {\n    if (location.id_flujo) {\n      return (\n        <div style={{ flexDirection: 'row' }}>\n          <CContainer>\n            <Alert show={show} variant=\"danger\" onClose={() => setShow(false)} dismissible>\n              <Alert.Heading>Error!</Alert.Heading>\n              <p>No has llenado todos los campos.</p>\n            </Alert>\n            <Modal responsive variant=\"primary\" show={showM} onHide={() => Cancelar(2)} centered>\n              <Modal.Header closeButton>\n                <Modal.Title>Confirmación</Modal.Title>\n              </Modal.Header>\n              <Modal.Body>{mensaje}</Modal.Body>\n              <Modal.Footer>\n                <CButton color=\"secondary\" onClick={() => Cancelar(2)}>\n                  Cancelar\n                </CButton>\n                <CButton color=\"primary\" onClick={() => Cancelar(1)}>\n                  Aceptar\n                </CButton>\n              </Modal.Footer>\n            </Modal>\n            <div className=\"float-left\" style={{ marginBottom: '10px' }}>\n              <Button variant=\"primary\" size=\"sm\" onClick={() => history.goBack()}>\n                <FaArrowLeft />\n                &nbsp;&nbsp;Regresar\n              </Button>\n            </div>\n            <br />\n            <br />\n            <CCard style={{ display: 'flex', alignItems: 'center' }}>\n              <CCardBody style={{ width: '80%' }}>\n                <CForm style={{ width: '100%' }} onSubmit={handleSubmit}>\n                  <h1>Asignación de Grupo de Autorización</h1>\n                  <p className=\"text-medium-emphasis\">Asigne un grupo de autorización al pago</p>\n                  <CInputGroup className=\"mb-3\">\n                    <CInputGroupText>\n                      <FiCreditCard />\n                    </CInputGroupText>\n                    <CFormControl\n                      type=\"text\"\n                      placeholder=\"Nombre\"\n                      name=\"nombre\"\n                      value={location.pago}\n                      disabled={true}\n                    />\n                  </CInputGroup>\n                  <CInputGroup className=\"mb-3\">\n                    <CInputGroupText>\n                      <FaUsers />\n                    </CInputGroupText>\n                    <CFormSelect name=\"grupo_autorizacion\" onChange={handleInput}>\n                      <option value=\"0\">Seleccione un grupo de autorización. (Obligatorio)</option>\n                      {results.map((item, i) => {\n                        if (item.eliminado == 0 && item.activo == 1) {\n                          return (\n                            <option key={item.id_grupo} value={item.id_grupo}>\n                              {item.identificador}\n                            </option>\n                          )\n                        }\n                      })}\n                    </CFormSelect>\n                  </CInputGroup>\n                  <CInputGroup className={!showRadio ? 'd-none mb-3' : 'mb-3'}>\n                    <div>\n                      Sugerencias de grupos para pago\n                      <br />\n                      <br />\n                    </div>\n                    {sugerencias.map((item, i) => {\n                      return (\n                        <>\n                          <CInputGroup key={i}>\n                            <CFormCheck\n                              key={item.id_grupoautorizacion}\n                              value={item.id_grupoautorizacion}\n                              type=\"radio\"\n                              name=\"grupo_autorizacion_radio\"\n                              label={item.identificador}\n                              onChange={handleInput}\n                            />\n                          </CInputGroup>\n                        </>\n                      )\n                    })}\n                  </CInputGroup>\n                  <CButton color=\"primary\" type=\"submit\" block>\n                    Guardar Cambios\n                  </CButton>\n                </CForm>\n              </CCardBody>\n            </CCard>\n          </CContainer>\n        </div>\n      )\n    } else {\n      history.go(-1)\n      return (\n        <div className=\"sin-sesion\">\n          NO SE CARGÓ EL CÓDIGO DEL FLUJO. REGRESE A LA PANTALLA DE PAGOS.\n        </div>\n      )\n    }\n  } else {\n    history.push('/')\n    return <div className=\"sin-sesion\">SIN SESIÓN ACTIVA.</div>\n  }\n}\n\nexport default FlujoGrupo\n"],"sourceRoot":""}