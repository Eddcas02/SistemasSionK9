{"version":3,"sources":["services/postTipoFlujo.js","services/getTiposFlujo.js","views/components/flujos/tipoflujo/TiposFlujo.js"],"names":["API","process","postTipoFlujo","idTipo","descripcion","inicial","estado","opcion","id_usuario","token","ApiFinal","ApiWhere","datos","id_tipoflujo","id_estadoinicial","activo","data","JSON","stringify","fetch","method","body","headers","Authorization","Accept","then","response","json","catch","error","getTiposFlujo","length","TiposFlujo","history","useHistory","time","setTime","useState","session","clear","useSession","results","setList","permisos","setPermisos","show","setShow","setIdTipo","setOpcion","mensaje","setMensaje","async","Cancelar","idUsuario","id","postSesionUsuario","api_token","push","useEffect","mounted","items","tipos","getPerfilUsuario","detalle","deshabilitar","objeto","result","item","ExistePermiso","Modal","responsive","variant","onHide","centered","Header","closeButton","Title","Body","Footer","color","onClick","eliminarTipo","className","style","marginBottom","size","disabled","hover","align","textAlign","width","map","i","asignacion","eliminado","estadoinicial","title","pathname","nombre","mostrarModal"],"mappings":"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","file":"static/js/99.c08af008.chunk.js","sourcesContent":["const API = `${process.env.REACT_APP_API_URL}tipoflujo`\n\nexport function postTipoFlujo(idTipo, descripcion, inicial, estado, opcion, id_usuario, token) {\n  let ApiFinal = API\n  let ApiWhere = ''\n\n  var datos = {\n    id_tipoflujo: idTipo,\n    descripcion: descripcion,\n    id_estadoinicial: inicial,\n    activo: estado,\n    opcion: opcion,\n    id_usuario: id_usuario,\n  }\n\n  if (idTipo !== '' && opcion !== '') {\n    ApiWhere += '/' + idTipo + '/' + opcion\n  }\n  ApiFinal += ApiWhere\n\n  const data = JSON.stringify(datos)\n  return fetch(ApiFinal, {\n    method: 'POST',\n    body: data,\n    headers: {\n      Authorization: 'Bearer ' + token,\n      Accept: 'application/json',\n      'Content-type': 'application/json;charset=UTF-8',\n    },\n  })\n    .then((response) => response.json())\n    .then((response) => {\n      return response\n    })\n    .catch((error) => error)\n}\n","const API = `${process.env.REACT_APP_API_URL}tipoflujo`\n\nexport function getTiposFlujo(idTipo, descripcion, token) {\n  let ApiFinal = API\n  let ApiWhere = ''\n  if (idTipo !== null) {\n    if (ApiWhere.length > 0) {\n      ApiWhere += '&id_tipoflujo=' + idTipo\n    } else {\n      ApiWhere += '?id_tipoflujo=' + idTipo\n    }\n  }\n  if (descripcion !== null) {\n    if (ApiWhere.length > 0) {\n      ApiWhere += '&descripcion=' + descripcion\n    } else {\n      ApiWhere += '?descripcion=' + descripcion\n    }\n  }\n  ApiFinal += ApiWhere\n  return fetch(ApiFinal, {\n    method: 'GET',\n    headers: {\n      Authorization: 'Bearer ' + token,\n      Accept: 'application/json',\n    },\n  })\n    .then(function (response) {\n      return response.json()\n    })\n    .catch((error) => error)\n}\n","import React, { useState, useEffect } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport { useIdleTimer } from 'react-idle-timer'\nimport { Modal } from 'react-bootstrap'\nimport {\n  CButton,\n  CTable,\n  CTableBody,\n  CTableDataCell,\n  CTableHead,\n  CTableHeaderCell,\n  CTableRow,\n} from '@coreui/react'\nimport { getTiposFlujo } from '../../../../services/getTiposFlujo'\nimport { getPerfilUsuario } from '../../../../services/getPerfilUsuario'\nimport { postSesionUsuario } from '../../../../services/postSesionUsuario'\nimport { postTipoFlujo } from '../../../../services/postTipoFlujo'\nimport { useSession } from 'react-use-session'\nimport { FaPen, FaTrash } from 'react-icons/fa'\nimport '../../../../scss/estilos.scss'\n\nconst TiposFlujo = () => {\n  const history = useHistory()\n  const [time, setTime] = useState(null)\n  const { session, clear } = useSession('PendrogonIT-Session')\n  const [results, setList] = useState([])\n  const [permisos, setPermisos] = useState([])\n  const [show, setShow] = useState(false)\n  const [idTipo, setIdTipo] = useState(0)\n  const [opcion, setOpcion] = useState(0)\n  const [mensaje, setMensaje] = useState('')\n\n  useEffect(() => {\n    let mounted = true\n    let objeto = 'Modulo Tipos Flujo'\n    let idUsuario = 0\n    if (session) {\n      idUsuario = session.id\n    }\n    getTiposFlujo(null, null, session.api_token).then((items) => {\n      if (mounted) {\n        setList(items.tipos)\n      }\n    })\n    getPerfilUsuario(idUsuario, '2', objeto, session.api_token).then((items) => {\n      if (mounted) {\n        setPermisos(items.detalle)\n      }\n    })\n    return () => (mounted = false)\n  }, [])\n\n  function ExistePermiso(objeto) {\n    let result = 0\n    for (let item of permisos) {\n      if (objeto === item.objeto) {\n        result = 1\n      }\n    }\n    return result\n  }\n\n  async function Cancelar(opcion) {\n    if (opcion == 1) {\n      setShow(false)\n    } else if (opcion == 2) {\n      let idUsuario = 0\n      if (session) {\n        idUsuario = session.id\n      }\n      const respuesta = await postSesionUsuario(idUsuario, null, null, '2', session.api_token)\n      if (respuesta === 'OK') {\n        clear()\n        history.push('/')\n      }\n    }\n  }\n\n  function mostrarModal(id_tipoflujo, nombre, opcion) {\n    setIdTipo(id_tipoflujo)\n    setOpcion(opcion)\n    setShow(true)\n    setMensaje('Está seguro de eliminar el tipo de flujo ' + nombre + '?')\n  }\n\n  async function eliminarTipo(id_tipoflujo, opcion) {\n    if (opcion == 1) {\n      const respuesta = await postTipoFlujo(\n        id_tipoflujo,\n        '',\n        '',\n        '',\n        '2',\n        session.id,\n        session.api_token,\n      )\n      if (respuesta === 'OK') {\n        await getTiposFlujo(null, null, session.api_token).then((items) => {\n          setList(items.tipos)\n        })\n      }\n    } else if (opcion == 2) {\n      setShow(false)\n    }\n  }\n\n  if (session) {\n    let deshabilitar = false\n    if (ExistePermiso('Modulo Tipos Flujo') == 0) {\n      deshabilitar = true\n    }\n    return (\n      <>\n        <Modal responsive variant=\"primary\" show={show} onHide={() => Cancelar(opcion)} centered>\n          <Modal.Header closeButton>\n            <Modal.Title>Confirmación</Modal.Title>\n          </Modal.Header>\n          <Modal.Body>{mensaje}</Modal.Body>\n          <Modal.Footer>\n            <CButton color=\"secondary\" onClick={() => Cancelar(opcion)}>\n              Cancelar\n            </CButton>\n            <CButton\n              color=\"primary\"\n              onClick={() => eliminarTipo(idTipo, opcion).then(() => Cancelar(1))}\n            >\n              Aceptar\n            </CButton>\n          </Modal.Footer>\n        </Modal>\n        <div className=\"float-right\" style={{ marginBottom: '10px' }}>\n          <CButton\n            color=\"primary\"\n            size=\"sm\"\n            disabled={deshabilitar}\n            onClick={() => history.push('/tipoflujo/nuevo')}\n          >\n            Crear Nuevo\n          </CButton>\n        </div>\n        <CTable hover responsive align=\"middle\" className=\"mb-0 border\">\n          <CTableHead color=\"light\">\n            <CTableRow>\n              <CTableHeaderCell className=\"text-center\">Tipo Flujo</CTableHeaderCell>\n              <CTableHeaderCell className=\"text-center\">Estado Inicial</CTableHeaderCell>\n              <CTableHeaderCell className=\"text-center\">Estado</CTableHeaderCell>\n              <CTableHeaderCell style={{ textAlign: 'center', width: '20%' }}>\n                Acciones\n              </CTableHeaderCell>\n            </CTableRow>\n          </CTableHead>\n          <CTableBody>\n            {results.map((item, i) => {\n              let asignacion = ''\n              let estado = 'Inactivo'\n              if (item.eliminado == 0) {\n                if (item.activo == 1) {\n                  estado = 'Activo'\n                }\n                if (item.id_estadoinicial === '' || item.id_estadoinicial === '0') {\n                  asignacion = 'No asignado'\n                } else {\n                  asignacion = item.estadoinicial\n                }\n                return (\n                  <CTableRow key={item.id_tipoflujo}>\n                    <CTableDataCell className=\"text-center\">{item.descripcion}</CTableDataCell>\n                    <CTableDataCell className=\"text-center\">{asignacion}</CTableDataCell>\n                    <CTableDataCell className=\"text-center\">{estado}</CTableDataCell>\n                    <CTableDataCell className=\"text-center\">\n                      <CButton\n                        color=\"primary\"\n                        size=\"sm\"\n                        title=\"Editar Tipo Flujo\"\n                        disabled={deshabilitar}\n                        onClick={() =>\n                          history.push({\n                            pathname: '/tipoflujo/editar',\n                            id_tipoflujo: item.id_tipoflujo,\n                            id_estadoinicial: item.id_estadoinicial,\n                            descripcion: item.descripcion,\n                            estado: item.activo,\n                          })\n                        }\n                      >\n                        <FaPen />\n                      </CButton>{' '}\n                      <CButton\n                        color=\"danger\"\n                        size=\"sm\"\n                        title=\"Eliminar Tipo Flujo\"\n                        disabled={deshabilitar}\n                        onClick={() => mostrarModal(item.id_tipoflujo, item.descripcion, 1)}\n                      >\n                        <FaTrash />\n                      </CButton>\n                    </CTableDataCell>\n                  </CTableRow>\n                )\n              }\n            })}\n          </CTableBody>\n        </CTable>\n      </>\n    )\n  } else {\n    history.push('/')\n    return <div className=\"sin-sesion\">SIN SESIÓN ACTIVA.</div>\n  }\n}\n\nexport default TiposFlujo\n"],"sourceRoot":""}