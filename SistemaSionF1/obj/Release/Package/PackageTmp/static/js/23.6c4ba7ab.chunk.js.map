{"version":3,"sources":["services/postSesionUsuario.js","services/getUsuarios.js","assets/icons/logo.png","services/getPoliticas.js","services/postLogLogin.js","services/postLogIn.js","services/getCantidadDias.js","services/verificarConexion.js","services/postLogPassword.js","views/pages/login/Login.js"],"names":["API","process","postSesionUsuario","IdUsuario","Navegador","IP","Opcion","token","datos","data","JSON","stringify","fetch","method","body","headers","Authorization","Accept","then","response","json","catch","error","getUsuarios","idGrupo","idFlujo","Usuario","Estado","ApiFinal","ApiWhere","getPoliticas","idPolitica","Descripcion","length","postLogLogin","idUsuario","maximo","id_usuario","postLogIn","user","password","undefined","Login","history","useHistory","saveJWT","useSession","show","setShow","useState","mostrar","setMostrar","passwordShown","setPasswordShown","mensaje","setMensaje","color","setColor","titulo","setTitulo","politicas","setPoliticas","useEffect","mounted","items","form","setValues","usuario","handleInput","event","target","name","value","obtenerPolitica","politica","result","item","identificador","valor","async","estoyConectado","id","verificarConexion","crearSesion","cantidad","publicIp","require","agente","window","navigator","userAgent","navegadores","myip","v4","i","indexOf","revisarPolitica","cambiaPassword","respuesta","err","getCantidadDias","postLogPassword","parseInt","handleSubmit","preventDefault","md5","encoding","itemsLogin","users","activo","eliminado","cambia_password","conexion","cantidadIngresos","sesion","limiteconexion","verde","amarillo","secret","jwt","sign","email","nombre","apellido","user_name","nombre_usuario","estado","api_token","push","Alert","variant","onClose","dismissible","Heading","className","onClick","md","placeholder","onChange","type","xs","onSubmit","style","display","flexDirection","alignItems","justifyContent","width","height","backgroundColor","src","logo"],"mappings":"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","file":"static/js/23.6c4ba7ab.chunk.js","sourcesContent":["const API = `${process.env.REACT_APP_API_URL}sesionusuario`\n\nexport function postSesionUsuario(IdUsuario, Navegador, IP, Opcion, token) {\n  var datos = {\n    IdUsuario: IdUsuario,\n    Navegador: Navegador,\n    IP: IP,\n    Opcion: Opcion,\n  }\n\n  const data = JSON.stringify(datos)\n  return fetch(API, {\n    method: 'POST',\n    body: data,\n    headers: {\n      Authorization: 'Bearer ' + token,\n      Accept: 'application/json',\n      'Content-type': 'application/json;charset=UTF-8',\n    },\n  })\n    .then((response) => response.json())\n    .then((response) => {\n      return response\n    })\n    .catch((error) => error)\n}\n","const API = `${process.env.REACT_APP_API_URL}usuarios`\n\nexport function getUsuarios(idGrupo, idFlujo, Usuario, Estado, token) {\n  let ApiFinal = API\n  let ApiWhere = ''\n  if (idGrupo !== null) {\n    ApiWhere += '/' + idGrupo\n  }\n  if (idFlujo !== null) {\n    ApiWhere += '/' + idFlujo\n  }\n  if (Usuario !== null) {\n    ApiWhere += '/' + Usuario\n  }\n  if (Estado !== null) {\n    ApiWhere += '/' + Estado\n  }\n  ApiFinal += ApiWhere\n  return fetch(ApiFinal, {\n    method: 'GET',\n    headers: {\n      Authorization: 'Bearer ' + token,\n      Accept: 'application/json',\n    },\n  })\n    .then(function (response) {\n      return response.json()\n    })\n    .catch((error) => error)\n}\n","export default __webpack_public_path__ + \"static/media/logo.739acbb1.png\";","const API = `${process.env.REACT_APP_API_URL}politicas`\n\nexport function getPoliticas(idPolitica, Descripcion) {\n  let ApiFinal = API\n  let ApiWhere = ''\n  if (idPolitica !== null) {\n    if (ApiWhere.length > 0) {\n      ApiWhere += '&id_politica=' + idPolitica\n    } else {\n      ApiWhere += '?id_politica=' + idPolitica\n    }\n  }\n  if (Descripcion !== null) {\n    if (ApiWhere.length > 0) {\n      ApiWhere += '&descripcion=' + Descripcion\n    } else {\n      ApiWhere += '?descripcion=' + Descripcion\n    }\n  }\n  ApiFinal += ApiWhere\n  return fetch(ApiFinal)\n    .then(function (response) {\n      return response.json()\n    })\n    .catch((error) => error)\n}\n","const API = `${process.env.REACT_APP_API_URL}loglogin`\n\nexport function postLogLogin(idUsuario, maximo, token) {\n  var datos = {\n    id_usuario: idUsuario,\n    maximo: maximo,\n  }\n\n  const data = JSON.stringify(datos)\n  return fetch(API, {\n    method: 'POST',\n    body: data,\n    headers: {\n      Authorization: 'Bearer ' + token,\n      Accept: 'application/json',\n      'Content-type': 'application/json;charset=UTF-8',\n    },\n  })\n    .then((response) => response.json())\n    .then((response) => {\n      return response\n    })\n    .catch((error) => error)\n}\n","const API = `${process.env.REACT_APP_API_URL}login`\n\nexport function postLogIn(user, password) {\n  var datos = {\n    user: user,\n    password: password,\n  }\n\n  const data = JSON.stringify(datos)\n  return fetch(API, {\n    method: 'POST',\n    body: data,\n    headers: {\n      Accept: 'application/json',\n      'Content-type': 'application/json;charset=UTF-8',\n    },\n  })\n    .then((response) => response.json())\n    .then((response) => {\n      if (response.length !== undefined) {\n        return response\n      } else {\n        return null\n      }\n    })\n    .catch((error) => error)\n}\n","const API = `${process.env.REACT_APP_API_URL}calculardias`\n\nexport function getCantidadDias(idUsuario, token) {\n  let ApiFinal = API\n  let ApiWhere = ''\n  if (idUsuario !== null) {\n    ApiWhere += '/' + idUsuario\n  }\n  ApiFinal += ApiWhere\n  return fetch(ApiFinal, {\n    method: 'GET',\n    headers: {\n      Authorization: 'Bearer ' + token,\n      Accept: 'application/json',\n    },\n  })\n    .then(function (response) {\n      return response.json()\n    })\n    .catch((err) => err)\n}\n","const API = `${process.env.REACT_APP_API_URL}estoyconectado`\n\nexport function verificarConexion(IdUsuario, token) {\n  let ApiFinal = API\n  let ApiWhere = ''\n  if (IdUsuario !== null) {\n    ApiWhere += '/' + IdUsuario\n  }\n  ApiFinal += ApiWhere\n  return fetch(ApiFinal, {\n    method: 'GET',\n    headers: {\n      Authorization: 'Bearer ' + token,\n      Accept: 'application/json',\n    },\n  })\n    .then(function (response) {\n      return response.json()\n    })\n    .catch((error) => error)\n}\n","const API = `${process.env.REACT_APP_API_URL}logpassword`\n\nexport function postLogPassword(idUsuario, token) {\n  var datos = {\n    id_usuario: idUsuario,\n  }\n\n  const data = JSON.stringify(datos)\n  return fetch(API, {\n    method: 'POST',\n    body: data,\n    headers: {\n      Authorization: 'Bearer ' + token,\n      Accept: 'application/json',\n      'Content-type': 'application/json;charset=UTF-8',\n    },\n  })\n    .then((response) => response.json())\n    .then((response) => {\n      return response\n    })\n    .catch((error) => error)\n}\n","import React, { useState, useEffect } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport { Alert } from 'react-bootstrap'\nimport { FiUser, FiLock, FiEye } from 'react-icons/fi'\nimport { getUsuarios } from '../../../services/getUsuarios'\nimport { getPoliticas } from '../../../services/getPoliticas'\nimport { getCantidadDias } from '../../../services/getCantidadDias'\nimport { verificarConexion } from '../../../services/verificarConexion'\nimport { postLogPassword } from '../../../services/postLogPassword'\nimport { postSesionUsuario } from '../../../services/postSesionUsuario'\nimport { postLogLogin } from '../../../services/postLogLogin'\nimport { useSession } from 'react-use-session'\nimport logo from '../../../assets/icons/logo.png'\nimport md5 from 'md5'\nimport {\n  CButton,\n  CCard,\n  CCardBody,\n  CCardGroup,\n  CCol,\n  CContainer,\n  CForm,\n  CFormControl,\n  CInputGroup,\n  CInputGroupText,\n  CRow,\n} from '@coreui/react'\nimport { postLogIn } from 'src/services/postLogIn'\n\nconst Login = () => {\n  const history = useHistory()\n  const { saveJWT } = useSession('PendrogonIT-Session')\n  const [show, setShow] = useState(false)\n  const [mostrar, setMostrar] = useState(false)\n  const [passwordShown, setPasswordShown] = useState(false)\n  const [mensaje, setMensaje] = useState('')\n  const [color, setColor] = useState('')\n  const [titulo, setTitulo] = useState('')\n  const [politicas, setPoliticas] = useState([])\n\n  useEffect(() => {\n    let mounted = true\n    getPoliticas(null, null).then((items) => {\n      if (mounted) {\n        setPoliticas(items.politicas)\n      }\n    })\n    return () => (mounted = false)\n  }, [])\n\n  const [form, setValues] = useState({\n    usuario: '',\n    password: '',\n  })\n\n  const showPassword = () => {\n    setPasswordShown(passwordShown ? false : true)\n  }\n\n  const handleInput = (event) => {\n    setValues({\n      ...form,\n      [event.target.name]: event.target.value,\n    })\n  }\n\n  function obtenerPolitica(politica) {\n    let result = ''\n    for (let item of politicas) {\n      if (item.identificador == politica) {\n        result = item.valor\n      }\n    }\n    return result\n  }\n\n  async function estoyConectado(id, token) {\n    let result = false\n    const respuesta = await verificarConexion(id, token)\n    if (respuesta == 'Conectado') {\n      result = true\n    }\n    return result\n  }\n\n  async function crearSesion(id, cantidad, token) {\n    const publicIp = require('public-ip')\n    let agente = window.navigator.userAgent\n    var navegadores = ['Chrome', 'Firefox', 'Safari', 'Opera', 'Trident', 'MSIE', 'Edge']\n    const myip = await publicIp.v4()\n    for (var i in navegadores) {\n      if (agente.indexOf(navegadores[i]) != -1) {\n        if (cantidad == '0') {\n          return true\n        } else {\n          const respuesta = await postSesionUsuario(id, navegadores[i], myip, '1', token)\n          if (respuesta === 'OK') {\n            return true\n          } else {\n            return false\n          }\n        }\n      }\n    }\n  }\n\n  function clone(obj) {\n    if (obj === null || typeof obj !== 'object') {\n      return obj\n    }\n    var temp = obj.constructor()\n    for (var key in obj) {\n      temp[key] = clone(obj[key])\n    }\n    return temp\n  }\n\n  async function revisarPolitica(idUsuario, cambiaPassword, token) {\n    let result = false\n    let politica = obtenerPolitica('_LIMITE_CAMBIO_PASSWORD_')\n    const respuesta = await getCantidadDias(idUsuario, token)\n    if (respuesta == 'Vacio') {\n      const logpassword = await postLogPassword(idUsuario, token)\n      if (logpassword == 'OK') {\n        result = true\n      }\n    } else {\n      if (cambiaPassword == 1) {\n        if (parseInt(respuesta) >= parseInt(politica)) {\n          setMostrar(true)\n          setTitulo('Aviso!')\n          setColor('info')\n          setMensaje(\n            `Ya pasaron ${respuesta} días desde la última vez que cambió su contraseña. Debe actualizarla.`,\n          )\n        } else if (parseInt(respuesta) < parseInt(politica)) {\n          result = true\n        }\n      } else if (cambiaPassword == 0) {\n        result = true\n      }\n    }\n    return result\n  }\n\n  const handleSubmit = (event) => {\n    event.preventDefault()\n    postLogIn(form.usuario, md5(form.password, { encoding: 'binary' })).then((itemsLogin) => {\n      if (itemsLogin) {\n        getUsuarios(null, null, form.usuario, null, itemsLogin).then((items) => {\n          if (items) {\n            if (items.users.length > 0) {\n              for (let item of items.users) {\n                if (md5(form.password, { encoding: 'binary' }) === item.password) {\n                  if (item.activo == 1 && item.eliminado == 0) {\n                    revisarPolitica(item.id, item.cambia_password, itemsLogin).then((respuesta) => {\n                      if (respuesta == true) {\n                        estoyConectado(item.id, itemsLogin).then((conexion) => {\n                          //if (conexion == true) {\n                          //setShow(true)\n                          //setTitulo('Aviso!')\n                          //setColor('info')\n                          //setMensaje(\n                          //  'Parece que tu usuario tiene una sesión activa, cierra sesión y vuelve a intentarlo.',\n                          //)\n                          //} else {\n                          crearSesion(item.id, item.cantidadIngresos, itemsLogin).then((sesion) => {\n                            if (sesion == true) {\n                              let limiteconexion = obtenerPolitica('_LIMITE_TIEMPO_CONEXION_')\n                              let verde = obtenerPolitica('_SEMAFORO_VERDE')\n                              let amarillo = obtenerPolitica('_SEMAFORO_AMARILLO')\n                              const sign = require('jwt-encode')\n                              const secret = 'secret'\n                              const data = {\n                                email: item.email,\n                                name: item.nombre + ' ' + item.apellido,\n                                user_name: item.nombre_usuario,\n                                id: item.id,\n                                estado: item.activo,\n                                limiteconexion: limiteconexion,\n                                verde: verde,\n                                amarillo: amarillo,\n                                cantidadIngresos: item.cantidadIngresos,\n                                api_token: itemsLogin,\n                              }\n                              const jwt = sign(data, secret)\n                              saveJWT(jwt)\n                              if (item.cantidadIngresos == '0') {\n                                history.push('/usuarios/password')\n                              } else {\n                                history.push('/home')\n                              }\n                            }\n                          })\n                          //}\n                        })\n                      }\n                    })\n                  } else {\n                    setShow(true)\n                    setTitulo('Error!')\n                    setColor('danger')\n                    setMensaje(\n                      'Parece que tu usuario ha sido bloqueado o eliminado. Consulta con el soporte técnico.',\n                    )\n                  }\n                } else {\n                  setShow(true)\n                  setTitulo('Error!')\n                  setColor('danger')\n                  setMensaje('Credenciales incorrectas. Vuelva a intentarlo.')\n                  if (item.activo == 1 && item.eliminado == 0) {\n                    let valor = obtenerPolitica('_LIMITE_ERROR_LOGIN_')\n                    postLogLogin(item.id, valor, itemsLogin)\n                  }\n                }\n              }\n            } else {\n              setShow(true)\n              setTitulo('Error!')\n              setColor('danger')\n              setMensaje('Credenciales incorrectas. Vuelva a intentarlo.')\n            }\n          }\n        })\n      } else {\n        setShow(true)\n        setTitulo('Error!')\n        setColor('danger')\n        setMensaje('Credenciales incorrectas. Vuelva a intentarlo.')\n      }\n    })\n  }\n  return (\n    <>\n      <Alert show={show} variant={color} onClose={() => setShow(false)} dismissible>\n        <Alert.Heading>{titulo}</Alert.Heading>\n        <p>{mensaje}</p>\n      </Alert>\n      <Alert show={mostrar} variant={color} onClose={() => setMostrar(false)} dismissible>\n        <Alert.Heading>{titulo}</Alert.Heading>\n        <p>{mensaje}</p>\n        <hr />\n        <div className=\"d-flex justify-content-end\">\n          <CButton onClick={() => history.push('/recuperar')} color=\"primary\" variant=\"outline\">\n            Actualizar Contraseña\n          </CButton>\n        </div>\n      </Alert>\n      <div className=\"bg-light min-vh-100 d-flex flex-row align-items-center\">\n        <CContainer>\n          <CRow className=\"justify-content-center\">\n            <CCol md=\"9\">\n              <CCardGroup>\n                <CCard className=\"p-4\">\n                  <CCardBody>\n                    <CForm>\n                      <h1>Iniciar Sesión</h1>\n                      <p className=\"text-medium-emphasis\">Inicie sesión con su correo o usuario</p>\n                      <CInputGroup className=\"mb-3\">\n                        <CInputGroupText>\n                          <FiUser />\n                        </CInputGroupText>\n                        <CFormControl\n                          placeholder=\"Correo o Usuario\"\n                          name=\"usuario\"\n                          onChange={handleInput}\n                        />\n                      </CInputGroup>\n                      <CInputGroup className=\"mb-4\">\n                        <CInputGroupText>\n                          <FiLock />\n                        </CInputGroupText>\n                        <CFormControl\n                          type={passwordShown ? 'text' : 'password'}\n                          name=\"password\"\n                          placeholder=\"Password\"\n                          onChange={handleInput}\n                        />\n                        <CButton color=\"secondary\" variant=\"outline\" onClick={showPassword}>\n                          <FiEye />\n                        </CButton>\n                      </CInputGroup>\n                      <CRow>\n                        <CCol xs=\"6\">\n                          <CButton\n                            type=\"submit\"\n                            color=\"primary\"\n                            className=\"px-4\"\n                            onClick={handleSubmit}\n                            onSubmit={handleSubmit}\n                          >\n                            Iniciar Sesión\n                          </CButton>\n                        </CCol>\n                        <CCol xs=\"6\" className=\"text-right\">\n                          <CButton\n                            color=\"link\"\n                            className=\"px-4\"\n                            onClick={() => history.push('/recuperar')}\n                          >\n                            Olvidaste contraseña?\n                          </CButton>\n                        </CCol>\n                      </CRow>\n                    </CForm>\n                  </CCardBody>\n                </CCard>\n                <CCard className=\"text-blue py-5\">\n                  <CCardBody className=\"text-center\">\n                    <div\n                      style={{\n                        display: 'flex',\n                        flexDirection: 'column',\n                        alignItems: 'center',\n                        justifyContent: 'center',\n                      }}\n                    >\n                      <div style={{ width: '80%', height: '80%', backgroundColor: 'transparent' }}>\n                        <img style={{ width: '80%' }} src={logo} />\n                      </div>\n                    </div>\n                  </CCardBody>\n                </CCard>\n              </CCardGroup>\n            </CCol>\n          </CRow>\n        </CContainer>\n      </div>\n    </>\n  )\n}\n\nexport default Login\n"],"sourceRoot":""}